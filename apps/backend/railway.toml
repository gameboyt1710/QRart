[build]
builder = "nixpacks"
buildCommand = "npm install && npm run prisma:generate && npm run build:full"

[deploy]
startCommand = "npm run prisma:migrate:prod && npm run start"
healthcheckPath = "/health"
healthcheckTimeout = 100
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 3

# This single service serves both the API and the web UI
# In production, the backend serves the built React app from ../web/dist
# No need for separate web service!
